{% extends "base.html" %}
{% load static %}

{% block title %}Formulario de Trabajo - Llamkay{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/jobs/registro_individual.css' %}" />
{% endblock %}

{% block content %}
<body class="fondo">
  <div class="formulario">
    <div class="volver">
      <button type="button" id="btn-volver">← Volver</button>
    </div>

    <h2>Información del Trabajo</h2>
    <p>Detalles sobre tu oferta de trabajo</p>

    <form enctype="multipart/form-data" method="POST" id="form-trabajo">
      {% csrf_token %}

      {% if form.errors %}
        <div class="form-errors">
          <ul>
            {% for field in form %}
              {% for error in field.errors %}
                <li>{{ field.label }}: {{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <!-- Título y Pago -->
      <div class="seccion-container">
        <div class="seccion-titulo basicos">Información Básica</div>
        <div class="fila">
          <div class="campo">
            <label>{{ form.titulo.label }}</label>
            {{ form.titulo }}
          </div>
          <div class="campo">
            <label>{{ form.pago.label }}</label>
            {{ form.pago }}
          </div>
        </div>
      </div>

      <!-- Fecha y Hora límite -->
      <div class="seccion-container">
        <div class="seccion-titulo tiempo">Tiempo y Fechas</div>
        <div class="fila">
          <div class="campo">
            <label>{{ form.fecha_limite.label }}</label>
            {{ form.fecha_limite }}
          </div>
          <div class="campo">
            <label>{{ form.horas_limite.label }}</label>
            {{ form.horas_limite }}
          </div>
        </div>
      </div>

      <!-- Descripción y Herramientas -->
      <div class="seccion-container">
        <div class="seccion-titulo detalles">Detalles del Trabajo</div>
        <div class="campo">
          <label>{{ form.descripcion.label }}</label>
          {{ form.descripcion }}
        </div>
        <div class="campo">
          <label>{{ form.herramientas.label }}</label>
          {{ form.herramientas }}
        </div>
      </div>

      <!-- Dirección -->
      <div class="seccion-container">
        <div class="seccion-titulo ubicacion">Ubicación del Trabajo</div>
        <div class="direccion">
          <div class="campo">
            <label>Departamento</label>
            {{ form.id_departamento }}
          </div>
          <div class="campo">
            <label>Provincia</label>
            {{ form.id_provincia }}
          </div>
          <div class="campo">
            <label>Distrito</label>
            {{ form.id_distrito }}
          </div>
          <div class="campo">
            <label>Comunidad</label>
            {{ form.id_comunidad }}
          </div>
        </div>
        <div class="campo direccion-detalle">
          <label>Dirección detalle</label>
          {{ form.direccion_detalle }}
        </div>
      </div>

      <!-- Foto -->
      <div class="seccion-container">
        <div class="seccion-titulo multimedia">Imagen del Trabajo</div>
        <div class="campo foto-opcional">
          <label>{{ form.foto.label }}</label>
          {{ form.foto }}
          <img id="preview-imagen" src="" alt="Vista previa" class="preview-imagen" />
        </div>
      </div>

      <!-- Número de contacto WhatsApp -->
      <div class="seccion-container contacto-whatsapp">
        <div class="seccion-titulo contacto">Contacto WhatsApp</div>
        <div class="campo">
          <label for="id_numero_contacto">Número de contacto (WhatsApp) *:</label>
          <input type="tel" id="id_numero_contacto" name="numero_contacto" 
                 placeholder="Ej: +51999123456" maxlength="15" required />
          <small class="help-text">* Campo obligatorio. Formato: +51999123456</small>
        </div>
      </div>

      {{ form.estado.as_hidden }}

      <!-- Botones -->
      <div class="boton">
        {% if modo_edicion %}
          <button type="submit" class="btn-editar">Guardar Cambios</button>
          <a href="{% url 'jobs:all_trabajos' %}" class="btn-cancelar">Cancelar</a>
        {% else %}
          <button type="submit" class="btn-registrar">Completar Registro</button>
        {% endif %}
      </div>
    </form>
  </div>
</body>
{% endblock %}

{% block extra_js %}
<script>
  const urlVolver = "{% url 'jobs:admin_empleador' %}";
  const urlCargarProvincias = "{% url 'jobs:ajax_cargar_provincias' %}";
  const urlCargarDistritos = "{% url 'jobs:ajax_cargar_distritos' %}";
  const urlCargarComunidades = "{% url 'jobs:ajax_cargar_comunidades' %}";
</script>
<script src="{% static 'js/jobs/registro_individual.js' %}"></script>
{% endblock %}